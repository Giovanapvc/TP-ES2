{% extends 'base.html' %}
{% block title %}Músicas de {{ artist }}{% endblock %}

{% block content %}
  <h1 class="text-3xl font-semibold mb-4">Músicas de {{ artist }}</h1>
  <ul class="space-y-6">
    {% for s in songs %}
      <li class="bg-white p-4 rounded-2xl shadow">
        <div class="flex justify-between items-center">
          <h2 class="text-xl font-bold">{{ s.title }}</h2>
          {% if s.link %}
            <a href="{{ s.link }}" target="_blank" class="text-indigo-600 hover:underline text-sm">Ouvir ▶</a>
          {% endif %}
        </div>
        <p class="text-gray-500 capitalize">Gênero: {{ s.genre }}</p>
        <div class="mt-2">
          <span class="font-medium">Curtidas:</span> {{ likers_map[s.id]|length }}
          {% if likers_map[s.id] %}
            <small class="text-sm">({{ likers_map[s.id]|join(', ') }})</small>
          {% endif %}
        </div>
        <div class="mt-1">
          <span class="font-medium">Avaliação média:</span>
          {% if avg_ratings[s.id] is not none %}
            {{ "%.2f"|format(avg_ratings[s.id]) }} ★
          {% else %}
            Sem avaliações
          {% endif %}
        </div>
        <div class="mt-3">
          <h3 class="font-medium">Opiniões:</h3>
          <ul class="list-disc list-inside">
            {% if opinions_map[s.id] %}
              {% for o in opinions_map[s.id] %}
                <li><strong>{{ o.user }}:</strong> {{ o.text }}</li>
              {% endfor %}
            {% else %}
              <li class="text-gray-500">Sem opiniões ainda.</li>
            {% endif %}
          </ul>
        </div>
      </li>
    {% endfor %}
  </ul>
  <div class="mt-6">
    <a href="{{ url_for('artist_dashboard', name=artist) }}"
       class="inline-block px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">
      ← Voltar ao Painel
    </a>
  </div>
{% endblock %}
